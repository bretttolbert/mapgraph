<!DOCTYPE html>
<!--
File for experimenting with client side manipulation of SVG.
-->
<html>
<head>
<title>graphgame</title>
<style type="text/css">
body {
    font-family: sans-serif;
}
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
$(function(){
    setTimeout(ready, 500);
});

function ready() {
    //$('#svg').attr('src', '../svg/USA_Counties_with_FIPS_and_names.svg');
    var svg = document.getElementById('svg');
    var svgdoc = svg.getSVGDocument();
    if (!svgdoc) {
        console.log('SVG Document Failed To Load');
        return;
    }

    $.getJSON('graphgame.cgi?action=getNodes&af=us-states', function(data) {
        $.each(data.nodes, function(key, node) {
            var node = svgdoc.getElementById(node.str);
            $(node).click(function(){
                $('#nodeName').text(this.id);
                $(this).attr('fill', $('#fill').val());
            });
        });
    })
    .success(function() { console.log("second success"); })
    .error(function(jqXHR, textStatus, errorThrown) {
            console.log("error " + textStatus);
            console.log("incoming Text " + jqXHR.responseText);
        })
    .complete(function() { console.log("complete"); });

}
</script>
</head>
<body>
<embed id="svg" src="../svg/Map_of_USA_without_state_names.svg">
</embed>
<span id="nodeName"></span>
<br/>
fill: <input type="text" id="fill" value="red"/>
</body>
</html>
